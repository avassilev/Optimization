% !TeX spellcheck = en_GB
\documentclass[10pt]{beamer}
\usetheme{CambridgeUS}
%\usetheme{Boadilla}
\definecolor{myred}{RGB}{163,0,0}
%\usecolortheme[named=blue]{structure}
\usecolortheme{dove}
\usefonttheme[]{professionalfonts}
\usepackage[english]{babel}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{xcolor}
\usepackage{bm}
\usepackage{gensymb}
\usepackage{verbatim} 
\usepackage{paratype}
\usepackage{mathpazo}
\usepackage{listings}
\lstset{language=Python}

\usepackage{tikz}
\usetikzlibrary{matrix}

\DeclareMathOperator*{\interior}{int}

% Number theorem environments
\setbeamertemplate{theorem}[ams style]
\setbeamertemplate{theorems}[numbered]

% Reset theorem-like environments so that each is numbered separately
\usepackage{etoolbox}
\undef{\definition}
\theoremstyle{definition}
\newtheorem{definition}{\translate{Definition}}
\newtheorem{Fact}{\translate{Fact}}

% Change colours for theorem-like environments
\definecolor{mygreen1}{RGB}{0,96,0}
\definecolor{mygreen2}{RGB}{229,239,229}
\setbeamercolor{block title}{fg=white,bg=mygreen1}
\setbeamercolor{block body}{fg=black,bg=mygreen2}



\alt<presentation>
{\lstset{%
  basicstyle=\footnotesize\ttfamily,
  commentstyle=\slshape\color{green!50!black},
  frame = single,  
  keywordstyle=\bfseries\color{blue!50!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
  %escapechar=\#,
  showstringspaces = false,
  showtabs = false,
  tabsize = 2,
  emphstyle=\color{red}}
}
{
  \lstset{%
    basicstyle=\ttfamily,
    keywordstyle=\bfseries,
    commentstyle=\itshape,
    escapechar=\#,
    showtabs = false,
	tabsize = 2,
    emphstyle=\bfseries\color{red}
  }
} 

\title{R401: Statistical and Mathematical Foundations}
\subtitle{Lecture 18: Deterministic Optimal Control in Continuous Time: The Infinite Horizon Case}
\author{Andrey Vassilev}

\date{2016/2017} 
    
\AtBeginSection{\frame{\usebeamerfont{section title}\centering\insertsection}}

\begin{document}
\maketitle



\begin{frame}[fragile]
\frametitle{Lecture Contents}
\tableofcontents
\end{frame}

\begin{section}{Introduction}\label{sec:intro}

\begin{frame}[fragile]
\frametitle{The rationale behind infinite horizons}
\begin{itemize}\itemsep1em
\item We now start studying an important class of optimal control problems for which there is no finite terminal time $ T $. Thus, the objective functional will look like \[ \int_{0}^{\infty} F(x(t),u(t),t)\,dt \] or a version thereof.\pause
\item \alert{Why do we need the infinite planning horizon?}\pause
\item After all, people are mortal and we'll stop planning one day...
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{The rationale behind infinite horizons}
\begin{itemize}\itemsep1em
\item There are two (related) economic reasons why an infinite-horizon formulation might be appropriate:
\begin{enumerate}
\item Entities such as households and firms may exist indefinitely despite turnover in their composition (i.e. family members dying or moving, employees changing jobs etc.).
\item Often there is uncertainty about the end of the planning horizon. This can be conveniently modelled as an infinite horizon, especially when it is reasonable to assume that the true, finite horizon is sufficiently distant.
\end{enumerate}
\item A technical complication with finite planning horizons arises when state variables represent economically valuable resources (wealth, capital). In these common cases we need to either:
	\begin{itemize}
	\item exhaust the respective resource fully as required by optimality if there is no scrap value,  which is often implausible, or
	\item specify an appropriate scrap value term in the objective function, which may be difficult.
	\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{The rationale behind infinite horizons}
\begin{itemize}\itemsep1em
\item Apart from matters of interpretation, an infinite-horizon formulation eliminates some mathematical difficulties (one generally obtains simpler and cleaner expressions).
\item However, this is not costless, as certain other complications arise.
\item More specifically, we need to modify appropriately our definition of optimality to capture situations that arise in the case of an infinite horizon.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{The basic problem}
The problem we shall be studying is the following:
\begin{equation}\begin{split}
&\max_{u(t)\in \Omega(t)}~\int_{0}^{\infty}F(x(t),u(t),t)\,dt\\
&\text{s.t.}\\
&\dot{x}(t)=f(x(t),u(t),t),\quad x(0)=x_0.
\end{split}
\label{eq:InfHorOCproblem}
\end{equation}

Sometimes problem \eqref{eq:InfHorOCproblem} is replaced by a simplified version that reflects the structure of typical economic problems:
\begin{equation}\begin{split}
&\max_{u(t)\in \Omega(t)}~\int_{0}^{\infty}e^{-\rho t} \phi(x(t),u(t))\,dt, \quad \rho>0,\\
&\text{s.t.}\\
&\dot{x}(t)=f(x(t),u(t)),\quad x(0)=x_0.
\end{split}
\label{eq:simpleInfHorOCproblem}
\end{equation}
\end{frame}

\begin{frame}[fragile]
\frametitle{Specificities of the infinite-horizon setting}
\begin{itemize}\itemsep1em
\item One obvious requirement in order to have a well-defined problem is for the improper integral forming the objective functional to converge for every admissible state-control pair.
\item This leads to a relatively simple case, obtainable for instance for problem \eqref{eq:simpleInfHorOCproblem} when \[ |\phi(x,u)|\leq M,~\forall (x,u). \]
\item Unfortunately many problems do not admit such a clean characterization, necessitating a generalization of optimality criteria.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Specificities of the infinite-horizon setting}
\begin{itemize}\itemsep1em
\item It is possible to have situations in which the objective functional does not converge, yet for some state-control pair its value is greater than the value for every alternative state-control pair for every finite time horizon.
\item In such cases it is natural to think of the ``dominant'' state-control pair as optimal, even though the verification is more complex than comparing two numbers.
\item Other possibilities for defining optimality exist as well.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Optimality criteria in infinite-horizon problems}
Among popular optimality criteria when the integral in \eqref{eq:InfHorOCproblem} or \eqref{eq:simpleInfHorOCproblem} does not converge, the most permissive definition is the following:
\begin{definition}[Piecewise (PW) optimality]
An admissible pair $ (x^*(t),u^*(t)) $ is \emph{piecewise optimal} if for every $ T\geq 0 $, the restriction of $ (x^*(t),u^*(t)) $ to $ [0,T] $ is optimal for the corresponding fixed horizon problem with terminal condition $ x(T)=x^*(T) $ and $ \int_{0}^{T}F(x(t),u(t),t)\,dt $ as the objective functional.
\label{def:PWopt}
\end{definition}
\end{frame}

\begin{frame}[fragile]
\frametitle{Optimality criteria in infinite-horizon problems}
In contrast, one of the stricter definitions is that of overtaking optimality.

We need to define the quantity \[ D(t):= \int_{0}^{t}F(x^*(\tau),u^*(\tau),\tau)\,d\tau - \int_{0}^{t}F(x(\tau),u(\tau),\tau)\,d\tau.\]

\begin{definition}[Overtaking (OT) optimality]
An admissible pair $ (x^*(t),u^*(t)) $ is \emph{overtaking optimal} if there exists a number $ t' $ such that $ D(t)\geq 0,~ \forall t\geq t'. $
\label{def:OTopt}
\end{definition}\bigskip

It can be shown that overtaking optimality implies piecewise optimality.\bigskip

There are definitions of optimality that take an intermediate position between PW optimality and OT optimality in terms of strictness.
\end{frame}

\begin{frame}[fragile]
\frametitle{Pitfalls of applying the transversality condition in infinite-horizon problems}
\begin{itemize}\itemsep1em
\item In the finite-horizon setting the transversality conditions impose constraints on the terminal values of the adjoint variables $ \lambda(T) $. 
\item In the absence of a salvage value term they take the form $ \lambda(T)=0 $.
\item One is tempted to conjecture that the natural extension of this requirement to the infinite-horizon setting would be \[ \lim\limits_{T\rightarrow \infty}\lambda(T)=0 . \]
\item Unfortunately there are counterexamples showing that in general this is not the case and additional modifications are required to obtain NCs or SCs for optimality.
\end{itemize}
\end{frame}
\end{section}

\begin{section}{Optimality conditions in the infinite-horizon setting}\label{sec:NCsSCs}

\begin{frame}[fragile]
\frametitle{Necessary conditions for PW optimality}
The following result by H. Halkin provides NCs at the expense of a slight complication of the formulation of the Hamiltonian.

\begin{Fact}[Halkin]
Let $ (x^*(t),u^*(t) ) $ be a PW-optimal state-control pair for the problem \eqref{eq:InfHorOCproblem} and define the Hamiltonian as \begin{equation}
H = \textcolor{red}{\lambda_0} F(x,u,t) + \sum_{i=1}^{n}\lambda_i f_i(x,u,t).
\label{eq:HamiltP0}
\end{equation}

Then there exist a constant $ \lambda_0 $ and (piecewise) continuously differentiable functions $ \lambda_i(t),~i=1,\ldots,n $, such that for all $ t $
\begin{enumerate}
\item $ (\lambda_0,\lambda(t)) \neq (0,\ldots,0)$,
\item $ H(x^*(t),u^*(t),\lambda(t),t )\geq H(x^*(t),u(t),\lambda(t),t ),~\forall u(t)\in \Omega(t) $,
\item $ \dot{\lambda}(t) = -H'_x(x^*(t),u^*(t),\lambda(t),t) $.
\end{enumerate}

Moreover, either $ \lambda_0=0 $ or $ \lambda_0=1 $.
\label{fc:HalkinNCs}
\end{Fact}
\end{frame}

\begin{frame}[fragile]
\frametitle{Sufficient conditions for OT optimality}
\begin{Fact}[Mangasarian-type sufficiency]
Consider the problem \eqref{eq:InfHorOCproblem}, assuming that the set $ \Omega $ is convex and $ F,f $ are continuously differentiable with respect to $ u $. Suppose $ (x^*,u^*) $ is an admissible pair and there exists a continuous function $ \lambda(t) $ such that, using the Hamiltonian \eqref{eq:HamiltP0}, for $ \lambda_0=1 $ and $ t\geq 0 $ we have
\begin{enumerate}
\item $ u^*(t) $ maximizes $ H(x^*(t),u(t),\lambda(t),t )$ for $ u(t)\in \Omega $,
\item $ \dot{\lambda}(t) = -H'_x(x^*(t),u^*(t),\lambda(t),t) $,
\item $ H(x,u,\lambda(t),t ) $ is concave in $ (x,u),~\forall t \geq 0 $.
\end{enumerate}

Then the following transversality condition guarantees that $ (x^*,u^*) $ is overtaking optimal:

For all admissible $ x(t) $ there exists a number $ t' $ such that \[ \lambda(t)\cdot (x(t)-x^*(t))\geq 0,\quad t\geq t'. \]
\label{fc:SCsOT}
\end{Fact}
\end{frame}

\begin{frame}[fragile]
\frametitle{Comments on the SCs for OT optimality}
\begin{itemize}\itemsep1em
\item Fact \ref{fc:SCsOT} provides sufficiency conditions for a fairly general problem and strict definition of optimality.
\item The price we pay is that the transversality condition is rather cumbersome to check, as it requires us to compare a candidate trajectory $ x^* $ to all feasible alternatives $ x $.
\item This is realistic only in special cases.
\item As a result, the usual approach in economic applications is to resort to conditions that are easier to check but are applicable to less general problems.
\end{itemize}
\end{frame}










Sufficient conditions for optimality SHSS Th 9.11.1

A comment on necessary conditions - growth conditions, pitfalls etc

Example

State-space analysis

\end{section}

\begin{frame}[fragile]
\frametitle{Readings}
Main references:\bigskip

Seierstad and Syds\ae{}ter [SS]. \emph{Optimal control theory with economic applications}. Chapter 3.

Syds\ae{}ter et al. [SHSS] \emph{Further mathematics for economic analysis}. Chapter 9.\bigskip

Additional readings:

Sethi and Thompson [ST]. \emph{Optimal control theory: applications to management science and economics}. Chapter 3.
\end{frame}

\end{document}

